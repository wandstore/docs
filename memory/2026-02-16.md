# Memory Log — 2026-02-16

## WandStore Multi-Agent System Setup

### Agents Created
- **Ops** — Operations coordinator
- **Support** — Customer support
- **Eng** — Engineering
- **Cofounder** — Strategy, business
- **Copywriter** — Marketing copy
- **Designer** — Visual design
- **Marketing-Eng** — Landing pages, marketing assets
- **DevOps** — Infrastructure (not yet active)
- **Architect** — System design (not yet active)

### Department Structure
```
agents/
├── cofounder/
├── marketing/
│   ├── copywriter/
│   ├── designer/
│   └── marketing-eng/
├── engineering/
│   ├── devops/
│   ├── architect/
│   ├── senior-eng/
│   └── eng/
└── operations/
    ├── ops/
    └── support/
```

### GitHub Projects (Kanban Boards)
1. **WandStore Mission Control** — Strategic overview
2. **Marketing Board** — Copy → Design → Engineering → Complete
3. **Engineering Board** — Technical MVP development

### Landing Page Evolution
- **v1** — Basic template
- **v2** — GitHub Actions CI/CD
- **v3** — Luxury dark theme (amber gold)
- **v4** — Clerk.com inspired (clean, minimal, no icon cards)

### Key Technical Decisions
- **Platform:** Cloudflare (Workers, Durable Objects, KV, D1)
- **Shopify Integration:** Headless storefront
- **Durable Objects:** 1 per store + 1 per shopper (hierarchy)
- **Data Source:** Shopify Customer Accounts API
- **Checkout:** Use Shopify's existing checkout
- **Template:** Single template per shopper for MVP

### Workflow Established
- GitHub Issues for tasks
- GitHub Projects (Kanban) for visual workflow
- Agents spawn manually or via heartbeat
- Agents move cards when complete
- Labels per agent + status (in-progress, needs-review, completed)

### Skills Installed
- **frontend-design-ultimate** — Anti-AI-slop design principles
- **github-ops** — GitHub CLI operations
- **cloudflare-ops** — Cloudflare API operations
- **audio-transcription** — Whisper-based voice-to-text

### Tools Configured
- GitHub CLI (gh) authenticated
- Cloudflare API token set
- Whisper/faster-whisper for audio transcription
- GitHub Actions for landing page deployment

### Active Tasks
- Landing page v4 deployed (Clerk-inspired)
- Mobile menu bug fixed
- Logo concepts created (5 options)
- Engineering MVP discussion started

### User Preferences
- Wants agents organized by department
- Prefers Kanban boards over Issues for workflow
- Wants auto-trigger when cards move (not yet implemented)
- Values clean, professional design (Clerk.com reference)
- MVP focus: Single template, no admin dashboard

### Next Steps (From Conversation)
1. Research Shopify APIs for shopper data
2. Define Durable Object hierarchy implementation
3. Build MVP storefront generation
4. Implement auto-trigger for Kanban cards

## Architect ↔ Felipe Discussion (Pending)

**Topic:** AI-generated UI vs template-based approach for storefront

**Felipe's Position:** Wants LLM to generate unique UI code dynamically per shopper visit (not template-based)

**Architect's Concerns:**
- Performance: LLM calls take 2-10s, storefront needs <100ms
- Cost: $0.08/visit × 10K visits/day × 30 days = ~$24K/month
- Durable Object limits: 30s CPU time, LLM calls consume most of it

**Cost Breakdown Provided:**
| Scenario | Monthly Cost | Conditions |
|----------|--------------|------------|
| Bare minimum | ~$1,500 | 5K visits/day, cheap model, 50% cached |
| Moderate | ~$8,000 | 10K visits/day, mid-tier, 30% cached |
| Aggressive | ~$25,000 | 10K visits/day, premium model, no caching |

**Hybrid Alternative Proposed:**
- AI generates template library offline (10-50 variants)
- Runtime: select template + fill variables (<100ms)
- Cost: ~$50-200/month
- Keeps AI involvement in design without per-visit cost

**Waiting on Felipe's Answers:**
1. Actual daily visit volume for WandStore?
2. Which LLM? (Kimi K2, other?)
3. Is $3K-15K/month acceptable or hard no?

**Status:** Awaiting Felipe's response to proceed with recommendation

---

## Architect ↔ Felipe Discussion (Update)

**New Direction (Felipe's Response):**
- Not worried about $24K/month cost yet (pre-launch, starting from zero)
- Needs 2-4 demo templates for investor pitches only
- Each template represents a different shopper persona
- Scale/cost optimization comes later

**Architect's Proposal: "Persona-Driven Storefronts"**

| Persona | Profile | Storefront Vibe |
|---------|---------|-----------------|
| **The Minimalist** | Busy professional, values speed & clarity | Clean, sparse, quick-buy CTAs |
| **The Explorer** | Loves browsing, discovering new products | Rich imagery, storytelling, curated collections |
| **The Deal Hunter** | Price-sensitive, comparison shopper | Prominent discounts, bundles, urgency timers |
| **The Loyalist** | Repeat customer, knows what they want | Personalized recs, reorder shortcuts, VIP feel |

**Technical Approach:**
- AI generates 4 templates offline (one-time cost ~$5-20)
- Simple rule-based selector picks template at runtime
- Demo shows investors how store adapts to shopper type
- Cost: ~$25 one-time + $5/month hosting

**Next Steps Offered:**
1. Draft persona briefs for AI generation
2. Create GitHub issue to track work
3. Set up `/templates/` directory structure

**Status:** Awaiting Felipe's decision on which step to start with

---

## Architect ↔ Felipe Discussion (Final)

**Cloudflare Architecture Defined:**

| Service | Purpose |
|---------|---------|
| **Workers** | Edge compute for selector logic |
| **Durable Objects** | Shopper session state (visits, cart, persona) |
| **KV** | Store 4 AI-generated persona templates |
| **D1** | Analytics/behavior tracking (optional v2) |

**Request Flow:**
```
Shopper → Worker → Durable Object (get state) → Selector (pick persona) 
→ KV (fetch template) → Inject dynamic data → Return HTML (<100ms)
```

**Cost:** $0-5/month (vs $24K/month for LLM-per-visit)

**Investor Demo:** Side-by-side browser tabs showing different personas

**GitHub Issue Created:** https://github.com/wandstore/storefront/issues/15

---

## Architect ↔ Felipe Discussion (PIVOT)

**Felipe's Clarification:** Pre-generated template approach is **against WandStore's core concept**. WandStore = runtime UI generation.

**New Constraint:** Must generate UI at runtime using AI, not select from templates.

**Three Proposed Solutions:**

### 1. Containers + Background Generation (RECOMMENDED)
- Use Cloudflare Containers for LLM inference
- First visit: show fallback instantly (<100ms)
- Background: Container generates AI UI → stores in KV
- Return visits: show cached AI UI instantly
- **Cost:** $500-1,000/month for 1K daily users

### 2. Workers AI + Aggressive Caching
- Use native Workers AI with AI Gateway caching
- Stream responses where possible
- **Cost:** $1,200-12,000/month (depends on cache hit rate)

### 3. WASM + Lightweight Models (Experimental)
- Run quantized models directly in Workers
- No external API calls
- **Cost:** $50-200/month but lower quality

**GitHub Issue Updated:** https://github.com/wandstore/storefront/issues/15
- Complete pivot to runtime-first architecture
- Three solution options documented
- Implementation plan for Containers approach

**Next Steps:**
1. Get Cloudflare Containers beta access
2. Prototype Solution 1
3. Measure actual costs and latency

**Status:** Issue updated, awaiting decision on which solution to pursue

---

## Architect ↔ Felipe Discussion (Final)

**Cloudflare Architecture Defined:**

| Service | Purpose |
|---------|---------|
| **Workers** | Edge compute for selector logic |
| **Durable Objects** | Shopper session state (visits, cart, persona) |
| **KV** | Store 4 AI-generated persona templates |
| **D1** | Analytics/behavior tracking (optional v2) |

**Request Flow:**
```
Shopper → Worker → Durable Object (get state) → Selector (pick persona) 
→ KV (fetch template) → Inject dynamic data → Return HTML (<100ms)
```

**Cost:** $0-5/month (vs $24K/month for LLM-per-visit)

**Investor Demo:** Side-by-side browser tabs showing different personas

**GitHub Issue Created:** https://github.com/wandstore/storefront/issues/15

**Status:** Issue created with full architecture spec, implementation plan, and acceptance criteria

---

## Architect ↔ Felipe Discussion (Final)

**Cloudflare Architecture Defined:**

| Service | Purpose |
|---------|---------|
| **Workers** | Edge compute for selector logic |
| **Durable Objects** | Shopper session state (visits, cart, persona) |
| **KV** | Store 4 AI-generated persona templates |
| **D1** | Analytics/behavior tracking (optional v2) |

**Request Flow:**
```
Shopper → Worker → Durable Object (get state) → Selector (pick persona) 
→ KV (fetch template) → Inject dynamic data → Return HTML (<100ms)
```

**Cost:** $0-5/month (vs $24K/month for LLM-per-visit)

**Investor Demo:** Side-by-side browser tabs showing different personas

**Next Steps Offered:**
1. Create GitHub issue (formal tracking)
2. Start implementing (scaffold Worker + DO + KV now)
3. Adjust approach (different services/flow)

**Status:** Awaiting Felipe's decision


---

## Phase 2: Cloudflare Container Deployment (In Progress)

**Status:** Multiple attempts to deploy Cloudflare Container for runtime AI generation

**Issues Encountered:**
1. **API Token Permissions** — Token lacked Container permissions, required Global API Key
2. **Docker Build Issues** — TypeScript compilation errors, missing type definitions
3. **Container Registry** — Image name format, registry path confusion
4. **Durable Object Migrations** — Migration conflicts with existing DO classes

**Current State:**
- Dockerfile simplified to copy pre-built JS (no TS compilation in container)
- GitHub Actions workflow builds TS in CI, then builds/pushes container
- Using `wrangler deploy` to handle container build and worker deployment
- Durable Object migration removed (class already exists)

**Pending:**
- Final workflow run to verify deployment
- Testing container runtime generation with Kimi API

**Key Learnings:**
- Cloudflare Containers require specific API token permissions
- `wrangler deploy` with `image = "./Dockerfile"` handles build/push automatically
- Durable Object migrations can't be reapplied to existing classes
